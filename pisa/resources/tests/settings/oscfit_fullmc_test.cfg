;------------------------------------------------------------------------------
; Settings directly affecting or handled by the template maker
;------------------------------------------------------------------------------

[pipeline]

; define order of stages to be excecuted one after another, and specify the
; service to use for each of them as stage1:serviceA, stage2:serviceB, ...
order = mc:gpu

;------------------------------------------------------------------------------
; Binning definitions, linked back to from stage definitions
;------------------------------------------------------------------------------

[binning]

fitter_checks.order = reco_coszen, reco_energy
fitter_checks.reco_energy = {'num_bins':10, 'is_log':True, 'bin_edges':[  5.01187234,   6.60693448,   8.7096359 ,  11.48153621, 15.13561248,  19.95262315,  26.30267992,  34.67368505, 45.70881896,  60.25595861,  79.43282347] * units.GeV, 'tex': r'$E_{\rm reco}$'}
fitter_checks.reco_coszen = {'num_bins':10, 'is_lin':True, 'domain':[-1,1], 'tex':r'$\cos\,\theta_{Z,{\rm reco}}$'}

;------------------------------------------------------------------------------
; Flux
;------------------------------------------------------------------------------

[stage:mc]

; instantiation arguments
output_binning = fitter_checks

error_method = none

param.events_file = events/deepcore_ic86/MSU/1XXXX/UnJoined/events__deepcore__IC86__runs_126001-126003,146001-146003,166001-166003__proc_v5digit__unjoined_with_fluxes_GENIE_Barr.hdf5
; BDT cut
param.bdt_cut = 0.2
; PID cuts
param.pid_bound = 3.0
param.pid_remove = -10000.0

; ---------- FLUX ------------
; * nu/nubar ratio
param.nu_nubar_ratio = 1.0 +/- 0.1
param.nu_nubar_ratio.fixed = True
param.nu_nubar_ratio.range = nominal + [-3., +3.] * sigma
; * nu_e/nu_mu ratio
param.nue_numu_ratio = 1.0 +/- 0.2
param.nue_numu_ratio.fixed = False
param.nue_numu_ratio.range = nominal + [-0.5, +0.5]
; Barr flux up/horizontal
param.Barr_uphor_ratio = 0.0 +/- 1.0
param.Barr_uphor_ratio.fixed = False
param.Barr_uphor_ratio.range = nominal + [-3.0, +3.0]
; Barr flux nu/nubar
param.Barr_nu_nubar_ratio = 0.0 +/- 1.0
param.Barr_nu_nubar_ratio.fixed = False
param.Barr_nu_nubar_ratio.range = nominal + [-3.0, +3.0]
; Spectral index
param.delta_index = 0.0 +/- 0.1
param.delta_index.fixed = False
param.delta_index.range = nominal + [-5, +5] * sigma

; ---------- OSC ------------
; Preliminary Reference Earth Model
param.earth_model = osc/PREM_12layer.dat
; electron densities
param.YeI = 0.4656
param.YeM = 0.4957
param.YeO = 0.4656
; height
param.detector_depth = 2. units.km
param.prop_height = 20. units.km
; skip oscillations for NC neutrinos
param.no_nc_osc = True

param.nutau_cc_norm = 1.0
param.nutau_cc_norm.fixed = False
param.nutau_cc_norm.range = nominal + [-1,+2]
param.nutau_cc_norm.prior = uniform

param.nu_nc_norm = 1.0
param.nu_nc_norm.fixed = False
param.nu_nc_norm.range = nominal + [-.5,+.5]
param.nu_nc_norm.prior = uniform
; solar angle
param.theta12 = <!fitter_checks|theta12!>
param.theta12.fixed = True
; reactor angle
param.theta13 = <!fitter_checks|theta13!>
param.theta13.fixed = False
param.theta13.range = [7.85, 9.1] * units.deg
; atmospheric angle
param.theta23 = <!fitter_checks|theta23!>
param.theta23.fixed = False
param.theta23.range = [30, 60] * units.deg
param.theta23.prior = uniform
; dirac phase
param.deltacp = <!fitter_checks|deltacp!>
param.deltacp.fixed = True
; solar mass splitting
param.deltam21 = <!fitter_checks|deltam21!>
param.deltam21.fixed = True
; atmospheric mass splitting
param.deltam31 = <!fitter_checks|deltam31!>
param.deltam31.fixed = False
param.deltam31.prior = uniform
param.deltam31.range = [-0.007, +0.007] * units.eV**2

; ---------- SCALES ------------
param.livetime = 2.5 units.common_year
; overall neutrino norm
param.aeff_scale = 1. +/- 0.1
param.aeff_scale.fixed = False
param.aeff_scale.range = nominal + [-0.3, +0.3]
; CC tau neutrino norm
param.nutau_cc_norm = 1.0
param.nutau_cc_norm.fixed = False
param.nutau_cc_norm.range = nominal + [-1,+2]
param.nutau_cc_norm.prior = uniform
; NC norm
param.nu_nc_norm = 1.0 +/- 0.2
param.nu_nc_norm.fixed = False
param.nu_nc_norm.range = nominal + [-.5,+.5]

; ---------- THEO ------------
; Genie axial masses
; Quasi Elastic
param.Genie_Ma_QE = 0.0 +/- 1.0
param.Genie_Ma_QE.fixed = False
param.Genie_Ma_QE.range = nominal + [-3.0, +3.0]
; Resonance
param.Genie_Ma_RES = 0.0 +/- 1.0
param.Genie_Ma_RES.fixed = False
param.Genie_Ma_RES.range = nominal + [-3.0, +3.0]

;reco sys raw (these are just used during slope fits)
param.reco_e_res_raw = 1.0
param.reco_e_scale_raw = 1.0
param.reco_cz_res_raw = 1.0

;------------------------------------------------------------------------------
; Define names for common things to use in the above
;------------------------------------------------------------------------------

[fitter_checks]

; Atmospheric mixing parameters used for samples comparison
theta12 = 33.460498694345453 units.deg

theta13 = 8.490662585025774 +/- 0.205 units.deg

theta23 = 42.245560664398468 units.deg

deltacp = 306 units.deg

deltam21 = 7.5e-5 units.eV**2

deltam31 = 0.002457  units.eV**2
